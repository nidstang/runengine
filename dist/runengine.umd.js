!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("runengine",[],n):"object"==typeof exports?exports.runengine=n():t.runengine=n()}(window,function(){return function(t){var n={};function r(e){if(n[e])return n[e].exports;var o=n[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=n,r.d=function(t,n,e){r.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,n){if(1&n&&(t=r(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)r.d(e,o,function(n){return t[n]}.bind(null,o));return e},r.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(n,"a",n),n},r.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},r.p="",r(r.s=0)}([function(t,n,r){"use strict";function e(t){return function(t){if(Array.isArray(t)){for(var n=0,r=new Array(t.length);n<t.length;n++)r[n]=t[n];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var r=[],e=!0,o=!1,i=void 0;try{for(var c,u=t[Symbol.iterator]();!(e=(c=u.next()).done)&&(r.push(c.value),!n||r.length!==n);e=!0);}catch(t){o=!0,i=t}finally{try{e||null==u.return||u.return()}finally{if(o)throw i}}return r}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}r.r(n),r.d(n,"createVec3",function(){return i}),r.d(n,"withTransform",function(){return u}),r.d(n,"ResourceLoader",function(){return a}),r.d(n,"createSprite",function(){return d}),r.d(n,"createRect",function(){return h}),r.d(n,"createViewport",function(){return l}),r.d(n,"Graphics",function(){return p}),r.d(n,"Camera",function(){return y}),r.d(n,"createEntity",function(){return v}),r.d(n,"createComponent",function(){return x}),r.d(n,"createScene",function(){return w});var i=function(t,n,r){return{coords:{x:t,y:n,z:r},multiply:function(t){return this.coords.x=this.coords.x*t,this.coords.y=this.coords.y*t,this.coords.z=this.coords.z*t,this},translateX:function(t){this.coords.x=t},translateY:function(t){this.coords.y=t},translateZ:function(t){this.coords.z=t},set:function(t){this.coords=t}}},c={position:i(0,0,0),size:i(0,0)},u=function(){return{transform:Object.create(c),getTransform:function(){var t=this.transform.position.coords,n=t.x,r=void 0===n?0:n,e=t.y,o=void 0===e?0:e,i=t.z,c=void 0===i?0:i,u=this.transform.size.coords,s=u.x,a=void 0===s?0:s,f=u.y;return{x:r,y:o,z:c,w:a,h:void 0===f?0:f}},setTransform:function(t){var n=t.x,r=void 0===n?0:n,e=t.y,o=void 0===e?0:e,c=t.z,u=void 0===c?0:c,s=t.w,a=void 0===s?0:s,f=t.h,d=void 0===f?0:f;return this.transform.position=i(r,o,u),this.transform.size=i(a,d),this},mapTransform:function(t){return t(this.getTransform())}}},s=function(t){var n=null;return{getInstance:function(){return n||(n=Object.create(t)),n}}},a=s({resources:{},load:function(t){var n=this;return new Promise(function(r,e){var i=t.length;t.forEach(function(t){var c=o(t,2),u=c[0],s=c[1],a=new Image;a.src=s,a.onload=function(){0===(i-=1)&&r()},a.onerror=function(t){e(t)},n.resources[u]=a})})},get:function(t){return this.resources[t]}}),f={setImage:function(t){this.image=t}},d=function(t){return Object.assign(Object.create(f),u(),t)},h=function(t){return Object.assign(u(),t)},l=function(t){return Object.assign(u(),t)},p=s({ctx:null,setContext:function(t){this.ctx=t},clear:function(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)},drawSprite:function(t){if(this.ctx){var n=t.getTransform(),r=n.x,e=n.y,o=n.w,i=n.h;this.ctx.drawImage(t.image,0,0,o,i,r,e,o,i)}},drawRect:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#000",r=t.getTransform(),e=r.x,o=r.y,i=r.w,c=r.h;this.ctx.save(),this.ctx.fillStyle=n,this.ctx.fillRect(e,o,i,c),this.ctx.restore()},getSprite:function(t){return d({image:a.getInstance().get(t)})}}),y=s({viewport:l(),setViewport:function(t){return this.viewport=t,this},followEntity:function(t){var n=t.getTransform(),r=n.x,e=n.y,o=n.w,i=n.h,c=this.viewport.getTransform(),u=c.w,s=c.h;return this.viewport.setTransform({x:r+o/2-u/2,y:e+i/2-s/2,w:u,h:s}),this},mapTransformInViewport:function(t){var n=t.x,r=t.y,e=t.z,o=t.w,i=t.h,c=this.viewport.getTransform();return{x:n-c.x,y:r-c.y,z:e,w:o,h:i}}}),m={components:[],addComponent:function(t){return this.components=[].concat(e(this.components),[Object.assign(t,{entity:this})]),this},update:function(){this.components.map(function(t){return t.update()})}},v=function(t){return Object.assign(Object.create(m),u(),t)},g={entity:v(),graphics:p.getInstance(),update:function(){return!0}},x=function(t){return Object.assign(Object.create(g),t)},b={entities:[],addEntity:function(t){this.entities=[].concat(e(this.entities),[t])},update:function(){this.entities.map(function(t){return t.update()})}},w=function(t){return Object.assign(Object.create(b),t)}}])});